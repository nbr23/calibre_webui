{% extends "base.html" %}

{% block page_title %}
{{title}}
{% endblock %}

{% block body %}
<div class="list-panel">
  <div class="list-panel-header">
    <h2>{{title}}</h2>
  </div>
  <div id="itemList">
    <div class="list-empty">Loading...</div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/{{ scope }}/list')
        .then(response => response.json())
        .then(items => {
            var itemList = document.getElementById('itemList');
            if (items.length === 0) {
                itemList.innerHTML = '<div class="list-empty">No items found</div>';
                return;
            }
            itemList.innerHTML = items.map(item =>
                '<div class="list-item">' +
                    '<span class="list-item-count">' + item.count + '</span>' +
                    '<div class="list-item-name">' +
                        '<a href="/?search=' + encodeURIComponent(item.name) + '&search_scope=' + encodeURIComponent('{{scope}}') + '">' + item.name + '</a>' +
                    '</div>' +
                '</div>'
            ).join('');
        })
        .catch(function() {
            document.getElementById('itemList').innerHTML = '<div class="list-empty">Error loading items</div>';
        });
});
</script>
{% endblock %}
